{% extends 'base.html' %}
{% load static %}

{% block 'body' %}

<style>
    /* Estilos para impress√£o, escondendo elementos desnecess√°rios */
    @media print {
        @page {
            size: A4; margin: 1.5cm;}
        body * {visibility: hidden;}
        .printable-area, .printable-area * {visibility: visible;}
        .printable-area { position: absolute; left: 0; top: 0; width: 100%; }
        .no-print { display: none !important; }
    }

    .assinatura {
        margin-top: 100px;
        text-align: center;
    }

    .linha-assinatura {
        border-top: 1px solid #000;
        width: 350px;
        margin: 0 auto;
        padding-top: 5px;
    }
</style>

<div class="container mt-4 printable-area">
    <!-- Bot√µes de A√ß√£o (n√£o ser√£o impressos) -->
    <div class="mb-4 no-print">
        <a href="{% url 'exames:detalhe_solicitacao' solicitacao.id %}" class="btn btn-secondary">‚Üê Voltar</a>
        <button class="btn btn-success" onclick="window.print()">
            üñ®Ô∏è Imprimir Pedido
        </button>
    </div>

<div class="border-bottom pb-3 mb-4">
        
        <!-- T√≠tulo da Cl√≠nica -->
        {% if perfil.nomeclinica %}
            <h3 class="text-center mb-4">{{ perfil.nomeclinica }}</h3>
        {% endif %}

        <!-- Linha do Grid para as 3 colunas -->
        <div class="row align-items-start">

            <!-- Coluna 1: Dados do Paciente -->
            <div class="col-4">
                <strong>Nome:</strong> {{ paciente.nome }} <br>

                <strong>Data de Nascimento:</strong> {{ paciente.datanascimento|date:"d/m/Y" }} <br>

                <strong>CPF:</strong> {{ paciente.cpf }}
            </div>

            <!-- Coluna 2: Dados do Profissional -->
            <div class="col-4">
                {% if perfil %}
                    <strong>Nutricionista:</strong> {{ perfil.nome_completo }} <br>

                    <strong>CPF:</strong> {{ perfil.cpf }} <br>

                    <strong>CFN:</strong> {{ perfil.cfn }}
                {% endif %}
            </div>

            <!-- Coluna 3: Logotipo -->
            <div class="col-4 text-end">
                {% if perfil.logotipo %}
                    <img src="{{ perfil.logotipo.url }}" height="80" class="mb-2">
                {% endif %}
            </div>

        </div>
    </div>


    <p class="text-end">Data de Solicita√ß√£o: {{ solicitacao.data_solicitacao|date:"d/m/Y" }}</p>
    <h3 class="text-center my-4">Solicita√ß√£o de Exames Laboratoriais</h3>

    <!-- 3. Lista de Exames Solicitados -->
    <div class="mb-5">
        <h5>Exames Solicitados:</h5>
        <ul class="list-group list-group-flush">
            {% for exame in exames_solicitados %}
                <li class="list-group-item border-0 ps-3">‚Ä∫ {{ exame.tipo_exame.nome }}</li>
            {% empty %}
                <li class="list-group-item border-0 ps-3">Nenhum exame nesta solicita√ß√£o.</li>
            {% endfor %}
        </ul>
    </div>
    
    <!-- 4. Data e Assinatura -->
    <div class="mt-5">
        
        
        <div class="assinatura">
            <div class="linha-assinatura"></div>
            <div class="mt-1">
                <strong>{{ perfil.nome_completo|default:"[Assinatura do Profissional]" }}</strong>
                
            </div>
        </div>
    </div>
</div>
{% endblock %}
